sync {
  default.rsyncssh,
  source = "<%= @source %>",
  targetdir = "<%= @targetdir %>",
  host = "<%= @host %>",
  <% unless @delete.nil? -%>
  delete = <%= @delete %>,
  <% end -%>
  <% unless @delay.nil? -%>
  delay = <%= @delay %>,
  <% end -%>
  <% unless @excludes.empty? %>
    exclude = {<% @excludes.each do |exclude| %> '<%= exclude %>', <% end %>},
  <% end %>
  rsync = {
    <% @rsync_options.each do |key, val| -%>
      <%= key %> = <%= val %>,
    <% end %>
  },
  ssh = {
    <% @ssh_options.each do |key, val| -%>
      <%= key %> = <%= val %>,
    <% end %>
  },
}
